<!DOCTYPE html>
<!--
Copyright 2010 Google Inc.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Original slides: Marcin Wichary (mwichary@google.com)
Original Modifications: Ernest Delgado (ernestd@google.com)
Alex Russell (slightlyoff@chromium.org)
Brad Neuberg

This is a slideshow based on http://slides.html5rocks.com
This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :)

-->
<html manifest="cache.manifest">
    <head>
        <!--[if gte IE 9]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <![endif]-->

        <!--[if lt IE 9]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge;chrome=1" />
        <![endif]-->

        <meta charset="utf-8" />
        <title>Postgresql Introduction - Felipe Prenholato, Ago/2010</title>
        <link href="google_local_import_font.css" rel="stylesheet" type="text/css" />
        <script type="text/javascript" src="jquery-1.4.2.min.js" charset="utf-8"></script>
        <style>
            body {
                font: 16px "Lucida Grande", "Trebuchet MS", Verdana, sans-serif;
                padding: 0;
                margin: 0;
                width: 100%;
                height: 100%;
                position: absolute;
                left: 0px; top: 0px;
            }

            .presentation {
                position: absolute;
                height: 100%;
                width: 100%;
                left: 0px;
                top: 0px;
                display: block;
                overflow: hidden;
                background: #778;
            }

            .slides {
                width: 100%;
                height: 100%;
                left: 0;
                top: 0;
                position: absolute;
                display: block;
                -webkit-transition: -webkit-transform 1s ease-in-out;
                -moz-transition: -moz-transform 1s ease-in-out;
                -o-transition: -o-transform 1s ease-in-out;
                transition: transform 1s ease-in-out;
            }

            .slide {
                display: none;
                position: absolute;
                overflow: hidden;
                width: 900px;
                height: 700px;
                left: 50%;
                top: 50%;
                margin-top: -350px;
                background-color: #eee;
                background: -webkit-gradient(linear, left bottom, left top, from(#cdcdcd), to(#fff));
                background: -moz-linear-gradient(bottom, #cdcdcd, #fff);
                background: linear-gradient(bottom, #cdcdcd, #fff);
                -webkit-transition: margin 0.25s ease-in-out;
                -moz-transition: margin 0.25s ease-in-out;
                -o-transition: margin 0.25s ease-in-out;
                transition: margin 0.25s ease-in-out;
            }

            .slide:nth-child(even) {
                -moz-border-radius: 20px 0;
                -khtml-border-radius: 20px 0;
                border-radius: 20px 0; /* includes Opera 10.5+ */
                -webkit-border-top-left-radius: 20px;
                -webkit-border-bottom-right-radius: 20px;
            }

            .slide:nth-child(odd) {
                -moz-border-radius: 0 20px;
                -khtml-border-radius: 0 20px;
                border-radius: 0 20px;
                -webkit-border-top-right-radius: 20px;
                -webkit-border-bottom-left-radius: 20px;
            }

            .slide p, .slide textarea {
                font-size: 20px;
            }

            .slide .counter {
                font-weight: bold;
                color: #999999;
                position: absolute;
                left: 20px;
                bottom: 20px;
                display: block;
                font-size: 12px;
            }

            .slide.title > .counter,
            .slide.segue > .counter,
            .slide.mainTitle > .counter {
                display: none;
            }

            .force-render {
                display: block;
                visibility: hidden;
            }

            .slide.far-past {
                display: block;
                margin-left: -2400px;
            }

            .slide.past {
                visibility: visible;
                display: block;
                margin-left: -1400px;
            }

            .slide.current {
                visibility: visible;
                display: block;
                margin-left: -450px;
            }

            .slide.future {
                visibility: visible;
                display: block;
                margin-left: 500px;
            }

            .slide.far-future {
                display: block;
                margin-left: 1500px;
            }

            body.three-d div.presentation {
                /*background: -webkit-gradient(radial, 50% 50%, 10, 50% 50%, 1000, from(#333), to(#000));        */
            }

            body.three-d div.slides {
                -webkit-transform: translateX(50px) scale(0.8) rotateY(10deg);
                -moz-transform: translateX(50px) scale(0.8) rotateY(10deg);
                -o-transform: translateX(50px) scale(0.8) rotateY(10deg);
                transform: translateX(50px) scale(0.8) rotateY(10deg);
            }

            /* Content */
            /*
            Font sizes:
            header h1 - 50px
            h2, p - 20px
            default, pre, input - 16px
            */

            @font-face { font-family: 'Junction'; src: url(src/Junction02.otf); }
            @font-face { font-family: 'LeagueGothic'; src: url(src/LeagueGothic.otf); }

            header {
                font-family: 'Droid Sans';
                font-weight: normal;
                letter-spacing: -.05em;
                color: black;
                text-shadow: rgba(0, 0, 0, 0.2) 0 2px 5px;
                position: absolute;
                left: 30px;
                top: 25px;
                margin: 0;
                padding: 0;
                font-size: 50px;
            }

            h1 {
                font-size: 100%;
                display: inline;
      	        font-weight: normal;
      	        padding: 0;
      	        margin: 0;
            }

            h2 {
                font-family: "Helvetica";
                color: black;
                font-size: 20px;
                padding: 0;
                margin: 15px 0 5px 0;

            }

            h2:first-child {
                margin-top: 0;
            }


            section, footer {
                font-family: '';
                color: #3f3f3f;
                text-shadow: rgba(0, 0, 0, 0.2) 0 2px 5px;
                margin: 100px 30px 0;
                display: block;
                overflow: hidden;
            }

            footer {
                font-size: 12px;
                margin: 20px 0 0 30px;
            }

            section footer {
                bottom: 22px;
                color: #999999;
                display: block;
                font-size: 12px;
                left: 10px;
                line-height: 12px;
                position: absolute;
            }

            a {
                color: inherit;
                display: inline-block;
                text-decoration: none;
                line-height: 110%;
                border-bottom: 2px solid #3f3f3f;
            }

            .gmap a {
                line-height: 100%;
                border-bottom: none;
            }

            li {
                list-style: none;
                padding: 10px 0;
            }

            button {
                font-size: 20px;
            }

            pre button {
                margin: 2px;
            }

            .summary {
                font-size: 30px;
            }

            .bullets {
                font-size: 40px;
            }

            section.left {
                float: left;
                width: 390px;
            }

            section.small {
                font-size: 24px;
            }

            section.small ul {
                margin: 0 0 0 15px;
                padding: 0;
            }

            section.small li {
                padding-bottom: 0;
            }

            section.middle {
                margin: 50px 0; 
                text-align: center;
                display: table-cell;
                vertical-align: middle;
                height: 700px;
                width: 900px;
            }

            pre, code {
                text-align: left;
                font-family: 'Consolas', Courier;
                padding: 0 20px;
                background: rgba(0, 0, 0, 0.8);
                -webkit-border-radius: 8px;
                -khtml-border-radius: 8px;
                -moz-border-radius: 8px;
                border-radius: 8px;
                border: 4px solid #999;
                white-space: pre;
                display: block;
                color: white;
            }

            pre select {
                font-family: Monaco, Courier;
                border: 1px solid #c61800;
            }

            input {
                font-size: 16px;
                margin-right: 10px;
                font-family: Helvetica;
                padding: 3px;
            }
            input[type="range"] {
                width: 100%;
            }

            button {
                margin: 20px 10px 0 0;
                font-family: Verdana;
            }

            button.large {
                font-size: 32px;
            }

            pre b {
                font-weight: normal;
                color: #c61800;
                text-shadow: #c61800 0 0 1px;
                /*letter-spacing: -1px;*/
            }
            pre em {
                font-weight: normal;
                font-style: normal;
                color: #18a600;
                text-shadow: #18a600 0 0 1px;
            }
            pre input[type="range"] {
                height: 6px;
                cursor: pointer;
                width: auto;
            }

            div.example {
                display: block;
                padding: 10px 20px;
                color: black;
                background: rgba(255, 255, 255, 0.4);
                -webkit-border-radius: 8px;
                -khtml-border-radius: 8px;
                -moz-border-radius: 8px;
                border-radius: 8px;
                margin-bottom: 10px;
                border: 1px solid rgba(0, 0, 0, 0.2);
            }

            video {
                -moz-border-radius: 8px;
                -khtml-border-radius: 8px;
                -webkit-border-radius: 8px;
                border-radius: 8px;
                border: 1px solid rgba(0, 0, 0, 0.2);
            }

            .css,
            .js,
            .html,
            .key {
                font-family: 'Droid Sans';
                color: black;
                display: inline-block;
                padding: 6px 10px 3px 10px;
                font-size: 25px;
                line-height: 30px;
                text-shadow: none;
                letter-spacing: 0;
                bottom: 10px;
                position: relative;
                -moz-border-radius: 10px;
                -khtml-border-radius: 10px;
                -webkit-border-radius: 10px;
                border-radius: 10px;
                background: white;
                box-shadow: rgba(0, 0, 0, 0.1) 0 2px 5px;
                -webkit-box-shadow: rgba(0, 0, 0, 0.1) 0 2px 5px;
                -moz-box-shadow: rgba(0, 0, 0, 0.1) 0 2px 5px;
                -o-box-shadow: rgba(0, 0, 0, 0.1) 0 2px 5px;
            }

            .key { font-family: Arial; }

            :not(header) > .css,
            :not(header) > .js,
            :not(header) > .html,
            :not(header) > .key {
                margin: 0 5px;
                bottom: 4px;
            }

            .css {
                background: -webkit-gradient(linear, left top, left bottom, from(#ff4), to(#ffa));
                background-color: #ff4;
                background: -moz-linear-gradient(left top, #ff4, #ffa);
            }
            .js {
                background: -webkit-gradient(linear, left top, left bottom, from(#4f4), to(#afa));
                background-color: #4f4;
                background: -moz-linear-gradient(left top, #4f4, #afa);
            }
            .html {
                background: -webkit-gradient(linear, left top, left bottom, from(#e88), to(#fee));
                background-color: #e88;
                background: -moz-linear-gradient(left top, #e88, #fee);
            }

            .two-column {
                -webkit-column-count: 2;
                -webkit-column-gap: 0;
                -webkit-column-rule: 1px solid red;
                -moz-column-count: 2;
                column-count: 2;
            }

            .summary li::before, .bullets li::before {
                content: '· ';
            }

            .stroke {
                -webkit-text-stroke-color: red;
                -webkit-text-stroke-width: 1px;
            } /* currently webkit-only */

            .center {
                text-align: center;
            }

            .formula {
                font-size: 50px;
            }

            #presentation-counter {
                color: #ccc;
                font-size: 100px;
                letter-spacing: 1px;
                position: absolute;
                top: 40%;
                left: 0;
                width: 100%;
                text-align: center;
            }

            section.text {
                margin: 50px;
                overflow: hide;
                height: 604px;
            }

            section.text h2 {
                text-align: left;
                margin: 0 auto;
                padding: 0;
                width: 90%;
                font-size: 33px;
                text-align: center;
                text-shadow: #9f9f9f 3px 3px 1px;
                text-transform: uppercase;
            }
            section.text p {
                font-size: 20px;
                line-height: 35px;
                margin-bottom: 35px;
            }
            section.text ul { }
            section.text ul li{
                list-style: square;
                font-size: 20px;
                line-height: 25px;
            }

        </style>
    </head>
    <body>
        <div class="presentation">
            <div id="presentation-counter"></div>

            <div class="slides">

                <div class="slide">
                    <style>
                        .landing {
                            font-size: 300%;
                            font-family: "Consolas";
                        }

                        .landing footer {
                            font-family: "Lucida Grande", "Trebuchet MS", Verdana, sans-serif
                        }

                        .landing p.license {
                            font-size: 14px;
                            width: 80%;
                            margin: 0 auto;
                        }
                    </style>
                    <section class="middle landing">
                    <h1>Uma breve introdução ao uso do <br/>PostgreSQL no dia a dia.</h1>
                    <br /><br />
                    <p>Felipe Prenholato - Ago/2010</p>
                    <br /><br />
                    <p class='license'><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Licença Creative Commons" style="border-width:0" src="cc-by-nc-sa_88x31.png" /></a><br />O conteúdo dessa obra é licenciada sob uma <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Licença Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported</a>.</p>
                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>

                        .indice { 
                            counter-reset: level1;
                        }

                        .indice .column1 {
                            width: 150px;
                            height: 600px;
                            float: left;
                        }

                        .indice .column2 {
                            margin: 140px 0 auto 200px;
                        }

                        .indice .column1 h2 {
                            -webkit-transform: rotate(90deg);
                            -moz-transform:rotate(90deg);
                            -o-transform: rotate(90deg);
                            color: #333;
                            display: block;
                            font-family: "Helvetica";
                            font-size: 104px;
                            font-weight: normal;
                            height: 150px;
                            margin: 100px 50px 100px 75px;
                            text-align: center;
                            text-shadow: #9f9f9f 6px 6px 4px;
                            text-transform: uppercase;
                            white-space: nowrap;
                            width: 20px;
                            writing-mode: tb-rl;
                        }


                        .indice p {
                            font-size: 25px;
                        }

                        .indice ol,
                        .indice ol li {
                            text-align: left;
                            font-size: 20px;
                            line-height: 24px;
                            margin-bottom: 0;
                            margin-top: 0;
                            padding-top: 0;
                            padding-bottom: 0;
                        }

                        .indice ol li {
                            margin-bottom: 3px;
                        }

                        .indice > ol {
                            margin: 30px auto;
                            width: 70%;
                        }

                        .indice > ol > li {
                            margin-bottom: 10px;
                        }

                        .indice ol li:before {
                            content: counter(level1) ". ";
                            counter-increment: level1;
                        }
                        .indice ol li ol {
                            list-style-type: none;
                            counter-reset: level2;
                        }
                        .indice ol li ol li:before {
                            content: counter(level1) "." counter(level2) " ";
                            counter-increment: level2;
                        }
                    </style>
                    <section class="middle indice text">
                    <div class="column1">
                        <h2>Indíce</h2>
                    </div>
                    <div class="column2">
                    <ol>
                        <li>Rápida introdução
                            <ol>
                                <li><a class='goto' href='#slide3'>O que é PostgreSQL?</a></li>
                                <li><a class='goto' href='#slide4'>Funcionalidades interessantes</a></li>
                            </ol>
                        </li>
                        <li>Uso básico
                        <ol>
                            <li><a class='goto' href='#slide5'>createdb / dropdb</a></li>
                            <li><a class='goto' href='#slide6'>createuser / dropuser</a></li>
                            <li><a class='goto' href='#slide7'>Populando a base / Scripting</a></li>
                            <li><a class='goto' href='#slide8'>Criando dumps (pg_dump)</a></li>
                        </ol>
                        </li>
                        <li>PostgreSQL shell
                        <ol>
                            <li><a class='goto' href='#slide9'>create table, select, insert, update, delete</a></li>
                            <li><a class='goto' href='#slide12'>exibir detalhes de tabelas, métodos, etc ...</a></li>
                        </ol>
                        </li>
                        <li><a class='goto' href='#slide14'>Permissionamento de usuários</a> <a class='goto' href='#slide15'>(exemplo)</a></li>
                        <li><a class='goto' href='#slide16'>Conectando com o PHP</a></li>
                        <li><a class='goto' href='#slide17'>Conectando com o Python</a></li>
                        <li><a class='goto' href='#slide18'>Conectando com o Django</a></li>
                        <li><a class='goto' href='#slide19'>Links úteis e referência</a></li>
                    </ol>
                    </div>
                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="intro text">
                    <h2>O que é PostgreSQL?</h2>

                    <p>O PostgreSQL é um SGBD relacional, open source e robusto, nascido
                    na UC Berkeley e derivado do INGRES, com sua primeira release em 1989.
                    Com seu desenvolvimento focado em funcionalidades e várias opções de
                    otimização para diferentes tipos de ambientes, hoje, já nas versões
                    8.x, ele é considerado o Oracle do mundo Open Source.</p>

                    <p>O PostgreSQL é indicado para qualquer tipo de aplicação, mas
                    sobretudo as que tendem a crescer muito com o tempo, e por sua gama
                    imensa de funcionalidades, normalmente é a escolha natural de
                    projetos open source. A comunidade envolvida no projeto é imensa e a
                    documentação é muito completa.</p>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="intro text">
                    <h2>Funcionalidades mais interessantes</h2>

                    <ul>
                        <li>Transações usando MVCC (Multi-Version Concurrency Control), que elimina o uso de
                        'read locks' assegurando o principio ACID (atomicity, consistency,
                        isolation, durability), que garante a consistência da base.</li>
                        <li>Suporte nativo a índices B+-tree, hash table, GiST bem como suporte a
                        índices criados pelos usuários.</li>
                        <li>Ótimo suporte a Triggers e Rules, que permitem que seja feito
                        um tipo de programação bastante complexa mais perto da engine da
                        base de dados, garantindo melhor performance.</li>
                        <li>Suporte a Stored Procedures/Funções com suporte a vários tipos
                        de linguagem como Perl, Lua, Python, Ruby, Bash, C/C++,
                        PHP e outras faz com que possa se usar o melhor de cada
                        linguagem para manipulação dos dados.</li>
                        <li>Tipos de dados, objetos, operadores e outros podem criados pelo
                        usuário.</li>
                        <li>Herança entre tabelas (similar a herança de classes em
                        Python/PHP).</li>
                    </ul>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Uso básico - createdb / dropdb</h2>

                    <p>O PostgreSQL usa comandos próprios para operações
                    básicas que normalmente seriam feitas via shell em outros
                    SGBDs, como o MySQL, embora também suporte os comandos no
                    shell.</p>

                    <p>O <strong>createdb</strong> é usado para criação de bases
                    de dados. Ele permite definir várias opções da
                    base de dados como locale, encoding, dono e até uma base
                    para usar como template para a atual. O <strong>dropdb</strong>
                    é usado para remover bases de dados. Segue um exemplo de
                    uso criando uma base de dados com encoding UTF-8 e locale
                    pt_BR (Brasil):</p>

                    <code>
 ~ $ createdb -e -O felipe -E UTF8 -l pt_BR.UTF-8 -T template0 test_db
CREATE DATABASE test_db OWNER felipe ENCODING 'UTF8' TEMPLATE template0
 LC_COLLATE 'pt_BR.UTF-8' LC_CTYPE 'pt_BR.UTF-8';

 ~ $ dropdb -e test_db
DROP DATABASE test_db;
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Uso básico - createuser / dropuser</h2>

                    <p>O <strong>createuser</strong> permite criar usuários com
                    diversos níveis de acesso, dos quais
                    <em>superuser</em>, <em>createrole</em> e <em>createdb</em>
                    são os principais. O comando é interativo a não ser que
                    você especifique uma das opções. A exclusão do
                    usuário com <strong>dropuser</strong> só pode ser feita se
                    este não tiver nenhuma base relacionada a ele.</p>

                    <code>
 ~ $ createuser -e -W felipe
Shall the new role be a superuser? (y/n) n
Shall the new role be allowed to create databases? (y/n) n
Shall the new role be allowed to create more new roles? (y/n) n
Password:
CREATE ROLE felipe NOSUPERUSER NOCREATEDB NOCREATEROLE INHERIT LOGIN;

 ~ $ createdb -O felipe test_db && dropuser felipe
dropuser: removal of role "felipe" failed: ERROR:  role "felipe" cannot be dropped 
because some objects depend on it
DETAIL:  owner of database test_db

 ~ $ dropdb test_db && dropuser -e felipe
DROP ROLE felipe;
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Populando a base / Scripting</h2>

                    <p>O PostgreSQL suporta SQL como outros SGBDs, logo ele
                    suporta scripting. Dumps são nada mais que scripts, e é
                    normal que precisemos sempre popular bases para testes ou
                    desenvolvimento. Existem várias maneiras de se popular uma
                    base e de enviar comandos SQL para o PostgreSQL sem entrar
                    em seu shell:</p>

                    <code>
 ~ $ # populando de arquivos e de outra base
 ~ $ psql -U felipe test_db < dump_de_alguma_base.sql
 ~ $ pg_dump -U felipe test_db | psql -U felipe test_db_2

 ~ $ # enviando comandos
 ~ $ psql -U felipe test_db <<< "select id,username from django_users; select id,username 
 from django_users limit 5;"

 ~ $ # enviando muitos comandos via bash
 ~ $ psql -U felipe test_db << EOF
insert into django_users (username) values ('felipe','daniel','juliana','antonio');
delete from django_users where username='daniel';
EOF
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Criando dumps (pg_dump)</h2>
                    
                    <p>Criar dumps é essencial para manter backups ou puxar
                    bases para testes. O PostgreSQL suporta dezenas de opções
                    sobre como construir o dump de sua base de dados. Vou
                    mostrar as mais usadas:</p>

                    <code>
 ~ $ # dump normal, direcionado para arquivo
 ~ $ pg_dump -U felipe test_db > test_db.sql

 ~ $ # dump compactado com bzip2, útil para transporte dos dados e backups
 ~ $ pg_dump -U felipe test_db | bzip2 -zv9 > test_db.sql

 ~ $ # forçando encoding
 ~ $ pg_dump -U felipe -E UTF-8 test_db

 ~ $ # pegando só algumas tabelas
 ~ $ pg_dump -U felipe -t auth_user -t auth_group test_db 

 ~ $ # dump com inserts completos em vez de só copy (copy usa menos espaço, mas 
 ~ $ # é mais difícil para trabalhar se você for editar/consultar o arquivo)
 ~ $ pg_dump -U felipe --column-inserts test_db
                    </code>
                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>CREATE TABLE, SELECT, INSERT, UPDATE, DELETE</h2>

                    <p>As operações usando PostgreSQL são bastante similares a
                    outros SGBDs, com alguns detalhes quanto
                    a nomes de coluna, campos para ID,
                    etc. Vamos a um exemplo usando a
                    tabela 'user' do PostgreSQL, que mostra os usuários com sessões
                    abertas:</p>

                    <code>
test_db=# select * from user;
   current_user
-------------------
 felipe.prenholato
(1 row)

test_db=# create table user (
  "id" serial NOT NULL PRIMARY KEY,
  "username" varchar(50),
  "dataCriacao" timestamp with time zone
);
ERROR:  syntax error at or near "user"
LINE 1: create table user (
                     ^
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>CREATE TABLE, SELECT, INSERT, UPDATE, DELETE</h2>

                    <p>Como a tabela user é um nome privado, nós
                    precisamos colocar entre aspas (") para poder usar ela como
                    uma tabela de nossa base:</p>

                    <code>
test_db=# create table <span style="color: #FF4600;">"user"</span> (
  "id" serial NOT NULL PRIMARY KEY,
  "username" varchar(50),
  "dataCriacao" timestamp with time zone
);
NOTICE:  CREATE TABLE will create implicit sequence "user_id_seq" for serial column "user.id"
NOTICE:  CREATE TABLE / PRIMARY KEY will create implicit index "user_pkey" for table "user"
CREATE TABLE

test_db=# insert into <span style="color: #FF4600;">"user"</span> (username,"dataCriacao") values ('felipe',NOW()), ('zé',NOW()), ('joão',NOW());
INSERT 0 3
test_db=# insert into user (username,"dataCriacao") values ('felipe',NOW()), ('zé',NOW()), ('joão',NOW());
ERROR:  syntax error at or near "user"
LINE 1: insert into user (username,"dataCriacao") values ('felipe',N...
                    ^
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>CREATE TABLE, SELECT, INSERT, UPDATE, DELETE</h2>

                    <p>As aspas duplas também se aplicam para nomes de colunas
                    com caracteres em maiúsculas, pois o o PostgreSQL é case
                    sensitive:</p>

                    <code>
test_db=# select id,username,dataCriacao from <span style="color: #FF4600;">"user"</span> limit 1;
ERROR:  column "datacriacao" does not exist
LINE 1: select id,username,dataCriacao from "user" limit 1;
                           ^
test_db=# select id,username,<span style="color: #FF4600;">"dataCriacao"</span> from <span style="color: #FF4600;">"user"</span> limit 1;
 id | username |          dataCriacao          
----+----------+-------------------------------
  1 | felipe   | 2010-08-30 11:38:51.656579-03
(1 row)

test_db=# update <span style="color: #FF4600;">"user"</span> set <span style="color: #FF4600;">"dataCriacao"</span> = NOW();
UPDATE 3

test_db=# delete from <span style="color: #FF4600;">"user"</span>;
DELETE 3
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Exibir detalhes de tabelas, métodos, etc ...</h2>

                    <p>No PostgreSQL é possível exibir vários detalhes de
                    tabelas, métodos, servidores e outras coisas com os
                    comandos <strong>\d*</strong>:</p>

                    <code>
test_db=# \dt
             List of relations
 Schema | Name | Type  |       Owner
--------+------+-------+-------------------
 public | user | table | felipe.prenholato
(1 row)

test_db=# \d user
                                    Table "public.user"
   Column    |           Type           |                     Modifiers
-------------+--------------------------+---------------------------------------------------
 id          | integer                  | not null default nextval('user_id_seq'::regclass)
 username    | character varying(50)    | 
 dataCriacao | timestamp with time zone | 
Indexes:
    "user_pkey" PRIMARY KEY, btree (id)
                    </code>
                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Exibir detalhes de tabelas, métodos, etc ...</h2>
                    <p>Comandos \d* mais usados:</p>
                    <code>
(options: S = show system objects, + = additional detail)
<strong style="color: #FF4600;">\d[S+]                 list tables, views, and sequences</strong>
<strong style="color: #FF4600;">\d[S+]  NAME           describe table, view, sequence, or index</strong>
\da[+]  [PATTERN]      list aggregates
\db[+]  [PATTERN]      list tablespaces
\dd[S]  [PATTERN]      show comments on objects
<strong style="color: #FF4600;">\df[antw][S+] [PATRN]  list [only agg/normal/trigger/window] functions</strong>
\dg[+]  [PATTERN]      list roles (groups)
\di[S+] [PATTERN]      list indexes
\dl                    list large objects, same as \lo_list
\do[S]  [PATTERN]      list operators
<strong style="color: #FF4600;">\dp     [PATTERN]      list table, view, and sequence access privileges</strong>
\ds[S+] [PATTERN]      list sequences
<strong style="color: #FF4600;">\dt[S+] [PATTERN]      list tables</strong>
\dT[S+] [PATTERN]      list data types
\du[+]  [PATTERN]      list roles (users)
\dv[S+] [PATTERN]      list views
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Permissionamento de usuários</h2>
                    <p>Você pode criar usuários pelo
                    <strong>createuser</strong>, mas o permissionamento dele é
                    feito através do arquivo pg_hba.conf. O arquivo contém uma
                    rica documentação e é achado em uma das seguintes
                    localizações (dependendo da distro Linux):</p>
                    <ul>
                        <li><strong>/var/lib/postgresql/&lt;PG_VERSION&gt;/data/pg_hba.conf</strong></li>
                        <li><strong>/etc/postgresql/&lt;PG_VERSION&gt;/main/pg_hba.conf</strong></li>
                    </ul>
                    <p>Nele é possível configurar os acessos para:</p>
                    <ul>
                        <li>diferentes tipos de autenticação, "trust", "password" e "indent" são os mais usados.</li>
                        <li>diferente usuários ou grupos de usuários ou uma lista de ambos.</li>
                        <li>uma base de dados específica, uma lista delas ou todas.</li>
                        <li>um ou mais IP, range de IPs ou sockets (e aceitando IPV6).</li>
                    </ul>
                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Permissionamento de usuários</h2>
                    <p>Exemplo de um arquivo pg_hba.conf:</p>
                    <code>
# TYPE  DATABASE    USER        CIDR-ADDRESS          METHOD
# "local" is for Unix domain socket connections only
# "host" is for IPv4 or IPv6 connections only

# todos acessam a test_db sem senha, mas só via socket
local   test_db     all                               trust
# só o felipe, logado como felipe no servidor, acessa a felipe_db via socket
local   felipe_db   felipe                            indent

# Usuários do grupo serviceusers tem acesso na rede 172.0.0.* com 
# autenticação via senha. Para criar um 'grupo' no PostgreSQL:
# create role servicesusers; grant mygroup to felipe,juliana;
host    services    +servicesusers   172.0.0.1/32     password

# Meu usuário felipe tem acesso a base de dados do amarok via socket ou web
# somente para localhost e usando senha, para digamos, integrar uma aplicação
# django com a base de dados usada pelo amarok :)
local   amarokdb   felipe                             password
host    amarokdb   felipe       127.0.0.1/32          password
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Conectando com o PHP</h2>

                    <p>É necessário compilar o php com
                    <strong>--with-pgsql[=DIR]</strong> ou em sistemas debian
                    like instalar o pacote <strong>php5-pgsql</strong>.
                    Instalado o suporte, você usa assim:</p>

                    <code>
&lt;?php // Exemplos em http://www.php.net/manual/en/pgsql.examples-basic.php

// Conectando na base
$dbconn = pg_connect("host=localhost dbname=amarokdb user=felipe password=felipe")

// Faz a query
$result = pg_query('SELECT author,title,time FROM "musics" order by "rating" desc')

// Pega cada linha como um objeto e mostra resultados, ex:
// Janis Joplin canta 'Summertime' em 4:07 minutos
while ($music = pg_fetch_object($result)) {
    echo $music-&gt;author + " canta '" + $music-&gt;title + "' em " + $music-&gt;time + " minutos"
}

// Libera o resultado e fecha a conexão
pg_free_result($result);
pg_close($dbconn);
?&gt;
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Conectando com o Python</h2>

                    <p>É necessário instalar o pacote psycopg versão 2.x. Em
                    sistemas debian like ele se chama
                    <strong>python-psycopg2</strong>. Instalado o suporte, você
                    usa assim:</p>

                    <code>
# Importa, abre conexão e seta o cursor
import psycopg2
conn = psycopg2.connect("dbname=test user=postgres")
cur = conn.cursor()

# Faz a query
cur.execute('SELECT author,title,time FROM "musics" order by "rating" desc')

# Pega cada linha como uma lista e mostra resultados, ex:
# Janis Joplin canta 'Summertime' em 4:07 minutos
for music in cur.fetchall():
    print "%s canta %s em %s minutos" % music

# Se você fez alterações na base também vai precisar do conn.commit(), pois
# PostgreSQL usa transações
# Fecha cursor e conexão
cur.close()
conn.close()
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                    </style>
                    <section class="text">
                    <h2>Conectando com o Django</h2>

                    <p>O Django, escrito em Python, também usa o psycopg2 como
                    driver, logo instale ele e:</p>

                    <code>
# No arquivo settings.py
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
...

# Já no shell pegamos cada linha como um objeto e mostramos os resultados, ex:
# Janis Joplin canta 'Summertime' em 4:07 minutos
for music in musics.objects.all():
    print "%s canta %s em %s minutos" % (music.author,music.title,music.time)

# O Django armazena a conexão usada com a base, logo podemos usar como se fosse
# o psycopg2 puro. É útil para queries muito complexas que o ORM possa não cobrir
from django.db import connection

cur = connection.cursor()
cur.execute('SELECT author,title,time FROM "musics" order by "rating" desc')
for music in cur.fetchall():
    print "%s canta %s em %s minutos" % music
                    </code>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

                <div class="slide">
                    <style>
                        /* if you have many links, this should resolve problem with space ;)
                        section.ref ul li {
                            font-size: 16px;
                            line-height: 18px;
                            padding: 3px;
                        }*/
                    </style>
                    <section class="ref text">
                    <h2>Links úteis e referência</h2>

                    <ul>
                        <li>Esta apresentação é um projeto open source, livre para uso não
                        comercial, seu código está no github: <a href="http://github.com/chronossc/postgres_presentation/">http://github.com/chronossc/postgres_presentation/</a></li>
                        <li>Manuais oficiais do PostgreSQL (em inglês): <a href="http://www.postgresql.org/docs/manuals/">http://www.postgresql.org/docs/manuals/</a></li>
                        <li>Traduções da documentação do PostgreSQL: <a href="http://www.postgresql.org.br/docs/">http://www.postgresql.org.br/docs/</a></li>
                        <li>PostgreSQL na Wikipédia, um pouco de história: <a href="http://en.wikipedia.org/wiki/Postgresql/">http://en.wikipedia.org/wiki/Postgresql/</a></li>
                        <li>PostgreSQL vs MySQL no WikiVS: <a href="http://www.wikivs.com/wiki/MySQL_vs_PostgreSQL">http://www.wikivs.com/wiki/MySQL_vs_PostgreSQL</a></li>
                        <li>PHP e PostgreSQL: <a href="http://www.php.net/manual/en/book.pgsql.php">http://www.php.net/manual/en/book.pgsql.php</a></li>
                        <li>Python e PostgreSQL - psycopg: <a href="http://initd.org/psycopg/docs/">http://initd.org/psycopg/docs/</a></li>
                        <li>Listas de discussão sobre PostgreSQL: <a href="http://archives.postgresql.org/">http://archives.postgresql.org/</a></li>
                        <li>Django project: <a href="http://www.djangoproject.org">http://www.djangoproject.org</a></li>
                    </ul>

                    <footer>This presentation engine is entire based on http://slides.html5rocks.com with only some cuts :). Navigate with directional keys, zoom/zoomout with Ctrl + +/-.</footer>
                    </section>
                </div>

            </div> <!-- slides -->

        </div> <!-- presentation -->

        <script>
            (function() {
                var doc = document;
                var disableBuilds = true;

                var ctr = 0;
                var spaces = /\s+/, a1 = [''];

                var toArray = function(list) {
                    return Array.prototype.slice.call(list || [], 0);
                };

                var byId = function(id) {
                    if (typeof id == 'string') { return doc.getElementById(id); }
                    return id;
                };

                var query = function(query, root) {
                    if (!query) { return []; }
                    if (typeof query != 'string') { return toArray(query); }
                    if (typeof root == 'string') {
                        root = byId(root);
                        if(!root){ return []; }
                    }

                    root = root || document;
                    var rootIsDoc = (root.nodeType == 9);
                    var doc = rootIsDoc ? root : (root.ownerDocument || document);

                    // rewrite the query to be ID rooted
                    if (!rootIsDoc || ('>~+'.indexOf(query.charAt(0)) >= 0)) {
                        root.id = root.id || ('qUnique' + (ctr++));
                        query = '#' + root.id + ' ' + query;
                    }
                    // don't choke on something like ".yada.yada >"
                    if ('>~+'.indexOf(query.slice(-1)) >= 0) { query += ' *'; }

                    return toArray(doc.querySelectorAll(query));
                };

                var strToArray = function(s) {
                    if (typeof s == 'string' || s instanceof String) {
                        if (s.indexOf(' ') < 0) {
                            a1[0] = s;
                            return a1;
                            } else {
                            return s.split(spaces);
                        }
                    }
                    return s;
                };

                var addClass = function(node, classStr) {
                    classStr = strToArray(classStr);
                    var cls = ' ' + node.className + ' ';
                    for (var i = 0, len = classStr.length, c; i < len; ++i) {
                        c = classStr[i];
                        if (c && cls.indexOf(' ' + c + ' ') < 0) {
                            cls += c + ' ';
                        }
                    }
                    node.className = cls.trim();
                };

                var removeClass = function(node, classStr) {
                    var cls;
                    if (classStr !== undefined) {
                        classStr = strToArray(classStr);
                        cls = ' ' + node.className + ' ';
                        for (var i = 0, len = classStr.length; i < len; ++i) {
                            cls = cls.replace(' ' + classStr[i] + ' ', ' ');
                        }
                        cls = cls.trim();
                        } else {
                        cls = '';
                    }
                    if (node.className != cls) {
                        node.className = cls;
                    }
                };

                var toggleClass = function(node, classStr) {
                    var cls = ' ' + node.className + ' ';
                    if (cls.indexOf(' ' + classStr.trim() + ' ') >= 0) {
                        removeClass(node, classStr);
                        } else {
                        addClass(node, classStr);
                    }
                };

                var ua = navigator.userAgent;
                var isFF = parseFloat(ua.split('Firefox/')[1]) || undefined;
                var isWK = parseFloat(ua.split('WebKit/')[1]) || undefined;
                var isOpera = parseFloat(ua.split('Opera/')[1]) || undefined;

                var canTransition = (function() {
                    var ver = parseFloat(ua.split('Version/')[1]) || undefined;
                    // test to determine if this browser can handle CSS transitions.
                    var cachedCanTransition = 
                    (isWK || (isFF && isFF > 3.6 ) || (isOpera && ver >= 10.5));
                    return function() { return cachedCanTransition; }
                })();

                //
                // Slide class
                //
                var Slide = function(node, idx) {
                    this._node = node;
                    if (idx >= 0) {
                        this._count = idx + 1;
                    }
                    if (this._node) {
                        addClass(this._node, 'slide distant-slide');
                    }
                    this._makeCounter();
                    this._makeBuildList();
                };

                Slide.prototype = {
                    _node: null,
                    _count: 0,
                    _buildList: [],
                    _visited: false,
                    _currentState: '',
                    _states: [ 'distant-slide', 'far-past',
                    'past', 'current', 'future',
                    'far-future', 'distant-slide' ],
                    setState: function(state) {
                        if (typeof state != 'string') {
                            state = this._states[state];
                        }
                        if (state == 'current' && !this._visited) {
                            this._visited = true;
                            this._makeBuildList();
                        }
                        removeClass(this._node, this._states);
                        addClass(this._node, state);
                        this._currentState = state;

                        // delay first auto run. Really wish this were in CSS.
                        /*
                        this._runAutos();
                        */
                        var _t = this;
                        setTimeout(function(){ _t._runAutos(); } , 400);
                    },
                    _makeCounter: function() {
                        if(!this._count || !this._node) { return; }
                        var c = doc.createElement('span');
                        c.innerHTML = this._count;
                        c.className = 'counter';
                        this._node.appendChild(c);
                    },
                    _makeBuildList: function() {
                        this._buildList = [];
                        if (disableBuilds) { return; }
                        if (this._node) {
                            this._buildList = query('[data-build] > *', this._node);
                        }
                        this._buildList.forEach(function(el) {
                            addClass(el, 'to-build');
                        });
                    },
                    _runAutos: function() {
                        if (this._currentState != 'current') {
                            return;
                        }
                        // find the next auto, slice it out of the list, and run it
                        var idx = -1;
                        this._buildList.some(function(n, i) {
                            if (n.hasAttribute('data-auto')) {
                                idx = i;
                                return true;
                            }
                            return false;
                        });
                        if (idx >= 0) {
                            var elem = this._buildList.splice(idx, 1)[0];
                            var transitionEnd = isWK ? 'webkitTransitionEnd' : (isFF ? 'mozTransitionEnd' : 'oTransitionEnd');
                            var _t = this;
                            if (canTransition()) {
                                var l = function(evt) {
                                    elem.parentNode.removeEventListener(transitionEnd, l, false);
                                    _t._runAutos();
                                };
                                elem.parentNode.addEventListener(transitionEnd, l, false);
                                removeClass(elem, 'to-build');
                                } else {
                                setTimeout(function() {
                                    removeClass(elem, 'to-build');
                                    _t._runAutos();
                                }, 400);
                            }
                        }
                    },
                    buildNext: function() {
                        if (!this._buildList.length) {
                            return false;
                        }
                        removeClass(this._buildList.shift(), 'to-build');
                        return true;
                    },
                };

                //
                // SlideShow class
                //
                var SlideShow = function(slides) {
                    this._slides = (slides || []).map(function(el, idx) {
                        return new Slide(el, idx);
                    });

                    var h = window.location.hash;
                    try {
                        this.current = parseInt(h.split('#slide')[1], 10);
                    }catch (e) { /* squeltch */ }
                    this.current = isNaN(this.current) ? 1 : this.current;
                    var _t = this;
                    doc.addEventListener('keydown', 
                    function(e) { _t.handleKeys(e); }, false);
                    doc.addEventListener('mousewheel', 
                    function(e) { _t.handleWheel(e); }, false);
                    doc.addEventListener('DOMMouseScroll', 
                    function(e) { _t.handleWheel(e); }, false);
                    doc.addEventListener('touchstart', 
                    function(e) { _t.handleTouchStart(e); }, false);
                    doc.addEventListener('touchend', 
                    function(e) { _t.handleTouchEnd(e); }, false);
                    window.addEventListener('popstate', 
                    function(e) { _t.go(e.state); }, false);
                    this._update();          
                };

                SlideShow.prototype = {
                    _slides: [],
                    _update: function(dontPush) {
                        document.querySelector('#presentation-counter').innerText = this.current;
                        if (history.pushState) {
                            if (!dontPush) {
                                history.pushState(this.current, 'Slide ' + this.current, '#slide' + this.current);
                            }
                            } else {
                            window.location.hash = 'slide' + this.current;
                        }
                        for (var x = this.current-1; x < this.current + 7; x++) {
                            if (this._slides[x-4]) {
                                this._slides[x-4].setState(Math.max(0, x-this.current));
                            }
                        }
                    },

                    current: 0,
                    next: function() {
                        if (!this._slides[this.current-1].buildNext()) {
                            this.current = Math.min(this.current + 1, this._slides.length);
                            this._update();
                        }
                    },
                    prev: function() {
                        this.current = Math.max(this.current-1, 1);
                        this._update();
                    },
                    go: function(num) {
                        if (history.pushState && this.current != num) {
                            history.replaceState(this.current, 'Slide ' + this.current, '#slide' + this.current);
                        }
                        this.current = num;
                        this._update(true);
                    },

                    _notesOn: false,
                    showNotes: function() {
                        var isOn = this._notesOn = !this._notesOn;
                        query('.notes').forEach(function(el) {
                            el.style.display = (notesOn) ? 'block' : 'none';
                        });
                    },
                    switch3D: function() {
                        toggleClass(document.body, 'three-d');
                    },
                    handleWheel: function(e) {
                        var delta = 0;
                        if (e.wheelDelta) {
                            delta = e.wheelDelta/120;
                            if (isOpera) {
                                delta = -delta;
                            }
                            } else if (e.detail) {
                            delta = -e.detail/3;
                        }

                        if (delta > 0 ) {
                            this.prev();
                            return;
                        }
                        if (delta < 0 ) {
                            this.next();
                            return;
                        }
                    },
                    handleKeys: function(e) {

                        if (/^(input|textarea)$/i.test(e.target.nodeName)) return;

                        switch (e.keyCode) {
                            case 37: // left arrow
                            this.prev(); break;
                            case 39: // right arrow
                            case 32: // space
                            this.next(); break;
                            case 50: // 2
                            this.showNotes(); break;
                            case 51: // 3
                            this.switch3D(); break;
                        }
                    },
                    _touchStartX: 0,
                    handleTouchStart: function(e) {
                        this._touchStartX = e.touches[0].pageX;
                    },
                    handleTouchEnd: function(e) {
                        var delta = this._touchStartX - e.changedTouches[0].pageX;
                        var SWIPE_SIZE = 150;
                        if (delta > SWIPE_SIZE) {
                            this.next();
                            } else if (delta< -SWIPE_SIZE) {
                            this.prev();
                        }
                    },
                };

                // Initialize
                var slideshow = new SlideShow(query('.slide'));

                $("a.goto").click(function(e) {
                    // use links to walk trought slides
                    t = parseInt($(this).attr('href').split('#slide')[1], 10)
                    if (t < slideshow.current) {
                        while (t < slideshow.current) { slideshow.prev() }
                        } else if (t > slideshow.current) {
                        while (t > slideshow.current) { slideshow.next() }
                    }

                    return false
                })
            })();
        </script>

        <!--[if lt IE 9]>
        <script 
            src="CFInstall.min.js">
        </script>
		<script>CFInstall.check({ mode: "overlay" });</script>
        <![endif]-->
    </body>
</html>
